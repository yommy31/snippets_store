# Decision Log

This file records architectural and implementation decisions using a list format.
2025-05-14 21:58:00 - Log of updates made.

*

## Decision

* 采用Next.js + FastAPI技术栈
* 使用SQLite作为数据库
* 采用四区域布局设计
* 使用Zustand进行状态管理
* 使用Tailwind CSS + shadcn/ui构建UI

## Rationale 

* **技术栈选择**：
  * Next.js提供良好的开发体验和性能优化
  * FastAPI提供高性能、易于开发的后端API
  * SQLite适合轻量级应用，无需额外数据库服务
* **布局设计**：四区域布局（顶部菜单、侧边导航、列表区、详情区）提供直观的用户体验
* **状态管理**：Zustand相比Redux更轻量，API简洁，适合中小型应用
* **UI框架**：Tailwind CSS提供高度可定制性，shadcn/ui提供美观且可访问的组件

## Implementation Details

* **数据模型**：
  * 使用UUID作为主键
  * 实现软删除（is_deleted标志）
  * 使用关联表处理多对多关系
* **API设计**：
  * 遵循RESTful原则
  * 实现批量操作API提高效率
* **前端架构**：
  * 组件化设计
  * 使用SWR进行数据获取和缓存
  * 实现响应式布局
2025-05-14 22:01:00 - 记录下一阶段开发计划决策。

## Decision

* 确定下一阶段开发优先级，将集合功能、搜索优化和UI完善作为高优先级任务
* 将导入/导出功能、性能优化和用户体验增强作为中优先级任务
* 将版本历史、离线支持和数据统计作为低优先级任务

## Rationale 

* **高优先级任务选择理由**：
  * 集合功能是设计文档中的核心功能，但尚未完全实现
  * 搜索是代码片段管理器的关键功能，良好的搜索体验对用户效率至关重要
  * 完善的UI和交互是提高用户体验的基础，应优先实现

* **中优先级任务选择理由**：
  * 导入/导出功能对数据迁移和备份很重要，但不影响核心功能使用
  * 性能优化在数据量较小时不是紧急问题，但随着使用会变得重要
  * 用户体验增强功能可以逐步添加，不影响基本功能

* **低优先级任务选择理由**：
  * 版本历史是高级功能，可在基础功能稳定后添加
  * 离线支持需要额外的存储和同步机制，复杂度较高
  * 数据统计主要用于长期使用分析，可在后期添加

## Implementation Details

* **开发方法**：
  * 采用迭代开发方式，每个功能点完成后进行测试
  * 优先实现核心功能，然后逐步添加辅助功能
  * 保持前后端同步开发，确保API和UI协调一致
[2025-05-14 22:28:00] - 实现Category文件夹式管理：修改了前端侧边栏组件，使Category以文件夹形式管理代码片段，添加了加号菜单（用于新建代码片段或子分类）和三点菜单（用于重命名、删除、移动等操作）。采用了递归组件结构来支持多层级分类展示。
[2025-05-14 22:47:30] - 优化Category文件夹式管理：使用shadcn的DropdownMenu组件替代原生prompt，改进了菜单交互体验；修复了目录重复显示问题，只显示根分类并通过递归展示子分类；添加了内联编辑功能，使用户可以直接编辑分类名称；优化了层级显示效果，增加了缩进和视觉区分。
[2025-05-14 23:06:00] - 优化Category文件夹式管理：修复了目录对齐问题，使用固定宽度的缩进和图标区域，确保所有分类项对齐；修复了新建代码片段功能，添加了延时确认机制确保状态正确更新；改进了新建分类的用户体验。（新建代码片段无法正常进入新建界面）